{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\nconst galleryLightbox = new SimpleLightbox('.gallery a', {\n  overlayOpacity: 0.8,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function renderGallery(images) {\n  const galleryItems = images\n    .map(image => {\n      return `\n        <li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${image.webformatURL}\"\n              data-source=\"${image.largeImageURL}\"\n              alt=\"${image.tags}\"\n            />\n            <ul class=\"gallery-info\">\n              <li>\n                <strong>Likes</strong>\n                <span>${image.likes}</span>\n              </li>\n              <li>\n                <strong>Views</strong>\n                <span>${image.views}</span>\n              </li>\n              <li>\n                <strong>Comments</strong>\n                <span>${image.comments}</span>\n              </li>\n              <li>\n                <strong>Downloads</strong>\n                <span>${image.downloads}</span>\n              </li>\n            </ul>\n          </a>\n        </li>\n      `;\n    })\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', galleryItems);\n\n  galleryLightbox.refresh();\n}\n","import axios from 'axios';\n\nexport async function getImages(search, page) {\n  const response = await axios.get('https://pixabay.com/api/', {\n    params: {\n      key: '45256893-9d571cd9ec15a1bc54f4c86f4',\n      q: search,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 15,\n      page,\n    },\n  });\n\n  return response.data;\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { renderGallery } from './js/render-functions';\nimport { getImages } from './js/pixabay-api';\n\nconst form = document.querySelector('.form');\nconst input = document.querySelector('.form-input');\nconst button = document.querySelector('.form-btn');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader-wrapper');\nconst loadMoreBtn = document.getElementById('load-more-button');\n\nlet prevSearchValue = '';\nlet page = 1;\nconst limit = 15;\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n\n  const formData = new FormData(event.target);\n  const search = formData.get('search').trim();\n\n  if (search.length > 0 && search !== prevSearchValue) {\n    gallery.innerHTML = '';\n    loader.classList.remove('hidden');\n    loadMoreBtn.classList.add('hidden');\n    input.disabled = true;\n    button.disabled = true;\n\n    prevSearchValue = search;\n    page = 1;\n\n    try {\n      const posts = await getImages(search, page);\n      if (posts.total === 0) {\n        iziToast.error({\n          message: `Sorry, there are no images matching your search query. Please try again!`,\n          position: 'topRight',\n        });\n      } else {\n        renderGallery(posts.hits);\n        if (posts.hits.length === limit) {\n          loadMoreBtn.classList.remove('hidden');\n        }\n      }\n    } catch (error) {\n      iziToast.error({\n        message: error.message,\n        position: 'topRight',\n      });\n    }\n\n    loader.classList.add('hidden');\n    input.disabled = false;\n    button.disabled = false;\n  }\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  loader.classList.remove('hidden');\n  loadMoreBtn.classList.add('hidden');\n  input.disabled = true;\n  button.disabled = true;\n  let isNotMorePosts = false;\n\n  try {\n    const posts = await getImages(prevSearchValue, page + 1);\n    const totalPages = Math.ceil(posts.totalHits / limit);\n    page = page + 1;\n\n    if (posts.hits.length < limit || totalPages <= page) {\n      isNotMorePosts = true;\n\n      iziToast.info({\n        message: `We're sorry, but you've reached the end of search results.`,\n        position: 'topRight',\n      });\n    }\n\n    if (posts.hits.length) {\n      renderGallery(posts.hits);\n\n      window.scrollBy({\n        top:\n          document.querySelector('.gallery-link').getBoundingClientRect()\n            .height * 2,\n        left: 0,\n        behavior: 'smooth',\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      message: error.message,\n      position: 'topRight',\n    });\n  }\n\n  if (!isNotMorePosts) {\n    loadMoreBtn.classList.remove('hidden');\n  }\n  loader.classList.add('hidden');\n  input.disabled = false;\n  button.disabled = false;\n});\n"],"names":["gallery","galleryLightbox","SimpleLightbox","renderGallery","images","galleryItems","image","getImages","search","page","axios","form","input","button","loader","loadMoreBtn","prevSearchValue","limit","event","posts","iziToast","error","isNotMorePosts","totalPages"],"mappings":"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"}